window.__require=function t(e,o,i){function s(h,r){if(!o[h]){if(!e[h]){var a=h.split("/");if(a=a[a.length-1],!e[a]){var c="function"==typeof __require&&__require;if(!r&&c)return c(a,!0);if(n)return n(a,!0);throw new Error("Cannot find module '"+h+"'")}h=a}var l=o[h]={exports:{}};e[h][0].call(l.exports,function(t){return s(e[h][1][t]||t)},l,l.exports,t,e,o,i)}return o[h].exports}for(var n="function"==typeof __require&&__require,h=0;h<i.length;h++)s(i[h]);return s}({backlogGroup:[function(t,e,o){"use strict";cc._RF.push(e,"87752eeZy1Gqa4kHeXOAgp2","backlogGroup"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){window.g_backlogGroup=this,this.m_shapes=[],this.createShape(),this.node.on("touchstart",this.touchStart,this),this.node.on("touchmove",this.touchMove,this),this.node.on("touchend",this.touchEnd,this),this.node.on("touchcancel",this.touchCancel,this)},start:function(){},createShape:function(){for(var t=0;t<this.node.children.length;t++){var e=g_shapeBuilder.createShape();e.node.scale=.5,this.node.children[t].addChild(e.node),this.m_shapes[t]=e}},getCurrentShap:function(t){return t.y>0||t.y<-213||t.x<0||t.x>640?null:(this.m_currentIndex=Math.floor(t.x/213),this.m_shapes[this.m_currentIndex])},clearMoveShape:function(){null!=this.m_moveShap&&(this.m_moveShap.node.removeFromParent(),this.m_moveShap=null)},clearCurrentShape:function(){var t=this.m_shapes[this.m_currentIndex];null!=t&&(t.node.removeFromParent(),this.m_shapes[this.m_currentIndex]=null)},createNewShapes:function(){null==this.m_shapes[0]&&null==this.m_shapes[1]&&null==this.m_shapes[2]&&this.createShape()},touchStart:function(t){this.clearMoveShape();var e=this.node.convertToNodeSpaceAR(t.getLocation()),o=this.getCurrentShap(e);null!=o&&(this.m_moveShap=new Object,this.m_moveShap.position=o.position,this.m_moveShap.node=cc.instantiate(o.node),this.m_moveShap.node.setPosition(e),this.m_moveShap.node.scale=1,this.node.addChild(this.m_moveShap.node),o.node.active=!1)},touchMove:function(t){if(null!=this.m_moveShap){var e=t.getLocation();e=this.node.convertToNodeSpaceAR(e),this.m_moveShap.node.setPosition(e)}},touchEnd:function(t){if(null!=this.m_moveShap){var e=this.m_moveShap.node.getPosition();e=this.node.convertToWorldSpaceAR(e),g_blockGroup.setShape(e,this.m_moveShap.node.children[0],this.m_moveShap.node.rotation,this.m_moveShap.position)?(this.clearMoveShape(),this.clearCurrentShape(),this.createNewShapes()):(this.showCurrentShape(),this.clearMoveShape()),this.checkCanContinue()||(cc.log("failed"),g_failed.show())}},checkCanContinue:function(){for(var t=0;t<this.m_shapes.length;t++)if(null!=this.m_shapes[t]&&g_blockGroup.canPut(this.m_shapes[t].position.checklist))return!0;return!1},touchCancel:function(t){this.showCurrentShape(),this.clearMoveShape()},showCurrentShape:function(){var t=this.m_shapes[this.m_currentIndex];null!=t&&(t.node.active=!0)},destroyAll:function(){if(null!=this.m_shapes)for(var t=0;t<this.m_shapes.length;t++)null!=this.m_shapes[t]&&(this.m_shapes[t].node.removeFromParent(),this.m_shapes[t].node.destroy(),this.m_shapes[t].node=null,this.m_shapes[t]=null);this.m_currentIndex=null,null!=this.m_moveShap&&(this.m_moveShap.node.removeFromParent(),this.m_moveShap.node.destroy(),this.m_moveShap.node=null,this.m_moveShap=null)}}),cc._RF.pop()},{}],blockGroup:[function(t,e,o){"use strict";cc._RF.push(e,"fd497ZUn+5NipwJJ+q8fXPW","blockGroup"),cc.Class({extends:cc.Component,properties:{m_imageAtlas:cc.SpriteAtlas,m_score:cc.Label},onLoad:function(){window.g_blockGroup=this,this.m_blockMap=new Array,this.m_scoreNum=0,this.init(),this.loadBlockGroup()},start:function(){},init:function(){for(var t=0;t<10;t++){this.m_blockMap[t]=new Array;for(var e=0;e<10;e++)this.m_blockMap[t][e]=null}},loadBlockGroup:function(){for(var t=0;t<10;t++)for(var e=64*t,o=0;o<10;o++){var i=64*o,s=new cc.Node;this.node.addChild(s),s.anchorX=0,s.anchorY=1,s.x=i,s.y=-e,s.scale=64/106;var n=s.addComponent(cc.Sprite),h=this.m_imageAtlas.getSpriteFrame("11");n.spriteFrame=h}},isNotInAvalibleArea:function(t,e){return!(t.x-64*e.width/2>=-32&&t.x+64*e.width/2<=672&&t.y+64*e.height/2<=32&&t.y-64*e.height/2>=-672)},checkPosition:function(t,e){if(t=this.node.convertToNodeSpaceAR(t),this.isNotInAvalibleArea(t,e))return!1;this.resetPosition(t,e);var o=Math.abs(t.x-e.center.x)/64,i=Math.abs(t.y-e.center.y)/64;this.m_checklist=[];for(var s=0;s<e.checklist.length;s++){var n=e.checklist[s].x+i,h=e.checklist[s].y+o;if(this.m_checklist[s]={x:n,y:h},null!=this.m_blockMap[n][h])return!1}return!0},setShape:function(t,e,o,i){return!!this.checkPosition(t,i)&&(this.setMapFlag(e,o),this.clearUp(),!0)},setMapFlag:function(t,e){for(var o=0;o<this.m_checklist.length;o++)if(null!=this.m_checklist[o]){var i=cc.instantiate(t);i.y=64*-this.m_checklist[o].x-32,i.x=64*this.m_checklist[o].y+32,i.rotation=e,this.m_blockMap[this.m_checklist[o].x][this.m_checklist[o].y]=i,this.node.addChild(i),this.m_scoreNum+=1,this.m_score.string=""+this.m_scoreNum,this.m_checklist[o]=null}},resetPosition:function(t,e){if(e.width%2==0){var o=t.x%64;t.x=o>=32?64*Math.ceil(t.x/64):64*Math.floor(t.x/64)}else t.x=64*Math.floor(t.x/64)+32;if(e.height%2==0){var i=t.y%64;t.y=i<=-32?64*Math.floor(t.y/64):64*Math.ceil(t.y/64)}else t.y=64*Math.ceil(t.y/64)-32},clearUp:function(){for(var t=new Array,e=new Array,o=0;o<10;o++){for(var i=!0,s=0;s<10;s++)if(null==this.m_blockMap[o][s]){i=!1;break}i&&t.push(o)}for(var n=0;n<10;n++){i=!0;for(var h=0;h<10;h++)if(null==this.m_blockMap[h][n]){i=!1;break}i&&e.push(n)}for(;t.length>0;)for(var r=t.pop(),a=0;a<10;a++)this.removeShap(r,a);for(;e.length>0;)for(var c=e.pop(),l=0;l<10;l++)this.removeShap(l,c)},removeShap:function(t,e){var o=this.m_blockMap[t][e];null!=o&&(this.m_scoreNum+=1,this.m_score.string=""+this.m_scoreNum,o.removeFromParent(),this.m_blockMap[t][e]=null,o=null)},canPut:function(t){for(var e=0;e<10;e++)for(var o=0;o<10;o++)if(null==this.m_blockMap[e][o]){for(var i=Math.abs(t[0].x-e),s=Math.abs(o-t[0].y),n=!1,h=1;h<t.length;h++){var r=t[h].x+i,a=t[h].y+s;if(r<0||a<0||r>=10||a>=10||null!=this.m_blockMap[r][a]){n=!0;break}}if(!n)return!0}return!1},destroyAll:function(){for(var t=0;t<10;t++)for(var e=0;e<10;e++)if(null!=this.m_blockMap[t][e]){if(null==this.m_blockMap[t][e])continue;this.m_blockMap[t][e].removeFromParent(),this.m_blockMap[t][e].destroy(),this.m_blockMap[t][e]=null}if(null!=this.m_checklist)for(var o=0;o<this.m_checklist.lenght;o++)this.m_checklist[o]=null;this.m_score.string="0",this.m_scoreNum=0}}),cc._RF.pop()},{}],failed:[function(t,e,o){"use strict";cc._RF.push(e,"2c881TQNENFEJ5Az8b2GIau","failed"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){window.g_failed=this,this.node.active=!1},start:function(){},show:function(){this.node.active=!0},restart:function(){g_backlogGroup.destroyAll(),g_blockGroup.destroyAll(),this.node.active=!1,g_backlogGroup.createShape()}}),cc._RF.pop()},{}],shapeBuilder:[function(t,e,o){"use strict";cc._RF.push(e,"bd2dfbUrVRL7oIvsK7Cznw9","shapeBuilder"),cc.Class({extends:cc.Component,properties:{m_shapeAtlas:cc.SpriteAtlas,m_shapes:[cc.Prefab],m_data:cc.JsonAsset},onLoad:function(){window.g_shapeBuilder=this,this.m_rotations=[0,270,180,90]},start:function(){},createShape:function(){var t=randomNum(0,11);t>8&&(t=t%2==0?8:7);var e=randomNum(0,3),o=cc.instantiate(this.m_shapes[t]);o.rotation=this.m_rotations[e],o.active=!0;var i=new Object;return i.node=o,i.position=this.m_data.json.shapes[t].positions[e],i}}),cc._RF.pop()},{}],testGroup:[function(t,e,o){"use strict";cc._RF.push(e,"13e715i6k9K15x4WM/G+GAe","testGroup"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}]},{},["backlogGroup","blockGroup","failed","shapeBuilder","testGroup"]);