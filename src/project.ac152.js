window.__require=function t(e,o,a){function s(i,r){if(!o[i]){if(!e[i]){var c=i.split("/");if(c=c[c.length-1],!e[c]){var h="function"==typeof __require&&__require;if(!r&&h)return h(c,!0);if(n)return n(c,!0);throw new Error("Cannot find module '"+i+"'")}i=c}var l=o[i]={exports:{}};e[i][0].call(l.exports,function(t){return s(e[i][1][t]||t)},l,l.exports,t,e,o,a)}return o[i].exports}for(var n="function"==typeof __require&&__require,i=0;i<a.length;i++)s(a[i]);return s}({backlogGroup:[function(t,e,o){"use strict";cc._RF.push(e,"87752eeZy1Gqa4kHeXOAgp2","backlogGroup"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){window.g_backlogGroup=this,this.m_shapes=[],this.createShape(),this.node.on("touchstart",this.touchStart,this),this.node.on("touchmove",this.touchMove,this),this.node.on("touchend",this.touchEnd,this),this.node.on("touchcancel",this.touchCancel,this)},start:function(){},createShape:function(){for(var t=0;t<this.node.children.length;t++){var e=g_shapeBuilder.createShape();e.node.scale=0,this.node.children[t].addChild(e.node),e.node.runAction(cc.scaleTo(.3,.5)),this.m_shapes[t]=e}},getCurrentShap:function(t){return t.y>0||t.y<-213||t.x<0||t.x>640?null:(this.m_currentIndex=Math.floor(t.x/213),this.m_shapes[this.m_currentIndex])},clearMoveShape:function(){null!=this.m_moveShap&&(this.m_moveShap.node.removeFromParent(),this.m_moveShap=null)},clearCurrentShape:function(){var t=this.m_shapes[this.m_currentIndex];null!=t&&(t.node.removeFromParent(),this.m_shapes[this.m_currentIndex]=null)},createNewShapes:function(){null==this.m_shapes[0]&&null==this.m_shapes[1]&&null==this.m_shapes[2]&&this.createShape()},touchStart:function(t){this.clearMoveShape();var e=this.node.convertToNodeSpaceAR(t.getLocation()),o=this.getCurrentShap(e);null!=o&&(this.m_moveShap=new Object,this.m_moveShap.position=o.position,this.m_moveShap.node=cc.instantiate(o.node),this.m_moveShap.node.x=e.x,this.m_moveShap.node.y=e.y+100,this.m_moveShap.node.scale=1,this.node.addChild(this.m_moveShap.node),o.node.active=!1)},touchMove:function(t){if(null!=this.m_moveShap){var e=t.getLocation();e=this.node.convertToNodeSpaceAR(e),this.m_moveShap.node.x=e.x,this.m_moveShap.node.y=e.y+100}},touchEnd:function(t){if(null!=this.m_moveShap){var e=this.m_moveShap.node.getPosition();e=this.node.convertToWorldSpaceAR(e),g_blockGroup.setShape(e,this.m_moveShap.node.children[0],this.m_moveShap.node.rotation,this.m_moveShap.position)?(this.clearMoveShape(),this.clearCurrentShape(),this.createNewShapes()):(this.showCurrentShape(),this.clearMoveShape()),this.checkCanContinue()||(cc.log("failed"),g_failed.show())}},checkCanContinue:function(){for(var t=0;t<this.m_shapes.length;t++)if(null!=this.m_shapes[t]&&g_blockGroup.canPut(this.m_shapes[t].position.checklist))return!0;return!1},touchCancel:function(t){this.showCurrentShape(),this.clearMoveShape()},showCurrentShape:function(){var t=this.m_shapes[this.m_currentIndex];null!=t&&(t.node.active=!0)},destroyAll:function(){if(null!=this.m_shapes)for(var t=0;t<this.m_shapes.length;t++)null!=this.m_shapes[t]&&(this.m_shapes[t].node.removeFromParent(),this.m_shapes[t].node.destroy(),this.m_shapes[t].node=null,this.m_shapes[t]=null);this.m_currentIndex=null,null!=this.m_moveShap&&(this.m_moveShap.node.removeFromParent(),this.m_moveShap.node.destroy(),this.m_moveShap.node=null,this.m_moveShap=null)}}),cc._RF.pop()},{}],blockGroup:[function(t,e,o){"use strict";cc._RF.push(e,"fd497ZUn+5NipwJJ+q8fXPW","blockGroup");var a=t("dataManager");cc.Class({extends:cc.Component,properties:{m_imageAtlas:cc.SpriteAtlas,m_score:cc.Label,m_scoreHistory:cc.Label},onLoad:function(){window.g_blockGroup=this,this.m_blockMap=new Array,this.m_scoreNum=0,this.dataManager=a(),this.init(),this.loadBlockGroup()},start:function(){this.dataManager.load(),this.m_scoreHistory.string=""+this.dataManager.getScore()},init:function(){for(var t=0;t<10;t++){this.m_blockMap[t]=new Array;for(var e=0;e<10;e++)this.m_blockMap[t][e]=null}},loadBlockGroup:function(){for(var t=0;t<10;t++)for(var e=64*t,o=0;o<10;o++){var a=64*o,s=new cc.Node;this.node.addChild(s),s.anchorX=0,s.anchorY=1,s.x=a,s.y=-e,s.scale=64/68;var n=s.addComponent(cc.Sprite),i=this.m_imageAtlas.getSpriteFrame("11");n.spriteFrame=i}},isNotInAvalibleArea:function(t,e){return!(t.x-64*e.width/2>=-32&&t.x+64*e.width/2<=672&&t.y+64*e.height/2<=32&&t.y-64*e.height/2>=-672)},checkPosition:function(t,e){if(t=this.node.convertToNodeSpaceAR(t),this.isNotInAvalibleArea(t,e))return!1;this.resetPosition(t,e);var o=Math.abs(t.x-e.center.x)/64,a=Math.abs(t.y-e.center.y)/64;this.m_checklist=[];for(var s=0;s<e.checklist.length;s++){var n=e.checklist[s].x+a,i=e.checklist[s].y+o;if(this.m_checklist[s]={x:n,y:i},null!=this.m_blockMap[n][i])return!1}return!0},setShape:function(t,e,o,a){return!!this.checkPosition(t,a)&&(this.setMapFlag(e,o),this.clearUp(),!0)},setMapFlag:function(t,e){for(var o=0;o<this.m_checklist.length;o++)if(null!=this.m_checklist[o]){var a=cc.instantiate(t);a.y=64*-this.m_checklist[o].x-32,a.x=64*this.m_checklist[o].y+32,a.rotation=e,a.width=56,a.height=56,this.m_blockMap[this.m_checklist[o].x][this.m_checklist[o].y]=a,this.node.addChild(a),this.updateScore(),this.m_checklist[o]=null}},resetPosition:function(t,e){if(e.width%2==0){var o=t.x%64;t.x=o>=32?64*Math.ceil(t.x/64):64*Math.floor(t.x/64)}else t.x=64*Math.floor(t.x/64)+32;if(e.height%2==0){var a=t.y%64;t.y=a<=-32?64*Math.floor(t.y/64):64*Math.ceil(t.y/64)}else t.y=64*Math.ceil(t.y/64)-32},clearUp:function(){for(var t=new Array,e=new Array,o=0;o<10;o++){for(var a=!0,s=0;s<10;s++)if(null==this.m_blockMap[o][s]){a=!1;break}a&&t.push(o)}for(var n=0;n<10;n++){a=!0;for(var i=0;i<10;i++)if(null==this.m_blockMap[i][n]){a=!1;break}a&&e.push(n)}for(;t.length>0;)for(var r=t.pop(),c=0;c<10;c++){if(null!=(p=this.m_blockMap[r][c])){var h=cc.callFunc(function(t,e){for(var o=0;o<10;o++)this.removeShap(e,o)},this,r);this.cleanUpAction(p,h,c,!0)}}for(;e.length>0;)for(var l=e.pop(),u=0;u<10;u++){var p;if(null!=(p=this.m_blockMap[u][l])){h=cc.callFunc(function(t,e){for(var o=0;o<10;o++)this.removeShap(o,e)},this,l);this.cleanUpAction(p,h,u,!1)}}},cleanUpAction:function(t,e,o,a){var s,n,i=cc.fadeTo(.5-.05*o,0);a?(n=cc.delayTime(.05*o),s=cc.moveBy(.5,cc.v2(0,-200))):(n=cc.delayTime(.05*(9-o)),s=cc.moveBy(.5,cc.v2(200,0)));var r=cc.sequence(n,cc.spawn(i,s));0==o&&(r=cc.sequence(r,e)),t.runAction(r)},removeShap:function(t,e){var o=this.m_blockMap[t][e];null!=o&&(this.updateScore(),o.removeFromParent(),this.m_blockMap[t][e]=null,o=null)},canPut:function(t){for(var e=0;e<10;e++)for(var o=0;o<10;o++)if(null==this.m_blockMap[e][o]){for(var a=Math.abs(t[0].x-e),s=Math.abs(o-t[0].y),n=!1,i=1;i<t.length;i++){var r=t[i].x+a,c=t[i].y+s;if(r<0||c<0||r>=10||c>=10||null!=this.m_blockMap[r][c]){n=!0;break}}if(!n)return!0}return!1},destroyAll:function(){for(var t=0;t<10;t++)for(var e=0;e<10;e++)if(null!=this.m_blockMap[t][e]){if(null==this.m_blockMap[t][e])continue;this.m_blockMap[t][e].removeFromParent(),this.m_blockMap[t][e].destroy(),this.m_blockMap[t][e]=null}if(null!=this.m_checklist)for(var o=0;o<this.m_checklist.lenght;o++)this.m_checklist[o]=null;this.m_score.string="0",this.m_scoreNum=0},updateScore:function(){this.m_scoreNum+=1,this.m_score.string=""+this.m_scoreNum;var t=this.dataManager.getScore();this.m_scoreNum>t&&(this.dataManager.updateScore(this.m_scoreNum),this.m_scoreHistory.string=""+this.m_scoreNum)}}),cc._RF.pop()},{dataManager:"dataManager"}],dataManager:[function(t,e,o){"use strict";cc._RF.push(e,"36ec5TYaxxExLKEmFQypR1m","dataManager"),e.exports=function(){var t=new Object;return t.userData={},t.load=function(){var e=cc.sys.localStorage.getItem("userData");t.userData=null!=e&&""!=e?JSON.parse(e):{score:0}},t.save=function(){var e=JSON.stringify(t.userData);cc.sys.localStorage.setItem("userData",e)},t.updateScore=function(e){t.userData.score=e,t.save()},t.getScore=function(){return null==t.userData.score&&(t.userData.score=0),t.userData.score},t},cc._RF.pop()},{}],failed:[function(t,e,o){"use strict";cc._RF.push(e,"2c881TQNENFEJ5Az8b2GIau","failed"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){window.g_failed=this,this.node.active=!1},start:function(){},show:function(){this.node.active=!0},restart:function(){g_backlogGroup.destroyAll(),g_blockGroup.destroyAll(),this.node.active=!1,g_backlogGroup.createShape()}}),cc._RF.pop()},{}],shapeBuilder:[function(t,e,o){"use strict";cc._RF.push(e,"bd2dfbUrVRL7oIvsK7Cznw9","shapeBuilder"),cc.Class({extends:cc.Component,properties:{m_shapeAtlas:cc.SpriteAtlas,m_shapes:[cc.Prefab],m_data:cc.JsonAsset},onLoad:function(){window.g_shapeBuilder=this,this.m_rotations=[0,270,180,90]},start:function(){},createShape:function(){var t=randomNum(0,11);t>8&&(t=t%2==0?8:7);var e=randomNum(0,3),o=cc.instantiate(this.m_shapes[t]);o.rotation=this.m_rotations[e],o.active=!0;var a=new Object;return a.node=o,a.position=this.m_data.json.shapes[t].positions[e],a}}),cc._RF.pop()},{}],testGroup:[function(t,e,o){"use strict";cc._RF.push(e,"13e715i6k9K15x4WM/G+GAe","testGroup"),cc.Class({extends:cc.Component,properties:{},start:function(){}}),cc._RF.pop()},{}]},{},["backlogGroup","blockGroup","dataManager","failed","shapeBuilder","testGroup"]);